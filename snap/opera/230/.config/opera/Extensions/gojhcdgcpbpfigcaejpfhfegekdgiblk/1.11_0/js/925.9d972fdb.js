"use strict";(self["webpackChunkdesktop_wallet"]=self["webpackChunkdesktop_wallet"]||[]).push([[925],{18027:function(t,e,i){i.d(e,{Z:function(){return g}});var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.activity&&t.token?i("div",{staticClass:"cursor-pointer flex my-3 p-4 rounded-lg t-activity_preview_item-transaction_detail",class:{"bg-dark-N16":!("pending"===t.txStatus),"bg-white":"pending"===t.txStatus,"text-spectrum-red":"failure"===t.txStatus,"text-white":!("pending"===t.txStatus),"text-dark-N16":"pending"===t.txStatus},on:{click:function(e){return t.openTransactionDetail(t.activity.hash)}}},[i("div",{staticClass:"mt-3 shrink-0"},[i("img",{class:[{"animate-spin":"pending"===t.txStatus}],attrs:{src:t.icons[t.txStatus]}})]),i("div",{staticClass:"flex items-center justify-between ml-4 truncate w-full"},[i("div",[i("div",{staticClass:"font-bold t-headline text-sm"},[t._v(t._s(t.headline))]),t.isRecipientOnly||t.isSenderOnly?t._e():i("div",{staticClass:"t-address text-dark-N77 text-sm",class:[{"text-spectrum-red":"failure"===t.txStatus}]},[t._v(" "+t._s(t.prettyAddress)+" ")])]),t.token?i("div",{staticClass:"text-end truncate"},[i("div",{staticClass:"flex font-bold justify-end text-sm"},[i("div",{staticClass:"max-w-[160px] pr-1 truncate",attrs:{title:t.value}},[t._v(" "+t._s(t.value)+" ")]),i("div",{staticClass:"max-w-[50px] min-w-[30px] truncate",attrs:{title:t.symbol}},[t._v(" "+t._s(t.symbol)+" ")])]),i("div",{staticClass:"text-dark-N77 text-sm",class:[{"text-spectrum-red":"failure"===t.txStatus}]},["pending"===t.txStatus?i("span",[t._v(t._s(t.$t("general.pending")+"..."))]):i("span",[t._v(t._s(t.timeOfActivity))])])]):t._e()])]):t._e()},a=[],n=i(500),r=i(35210),c=i(92496),o=i(20144),l=i(29652),d=i(4634),h=i(74597),u=i(27160),p=i(98180),v=o.Z.extend({name:"ActivityItem",props:{activity:{default:void 0,type:Object}},data(){const t=1e4;return{BASE_DELAY:t,delay:{bnb:t,btc:6e4,eth:t,matic:5e3},icons:{failure:i(98498),pending:i(71643),success:i(27176)},prettyAddress:`${this.$t("general.loading")}...`,timeOfActivity:"",token:void 0,txStatus:null,updateActivityInterval:null,updateTimeOfActivityInterval:null,updatingTxStatus:!1}},computed:{address(){const t=this.token?.chain.coinType||this.activity.chain.coinType;return this.$store.getters.accountsByCoinType[t].toLowerCase()},displayAddress(){if(this.isRecipientOnly)return this.recipient;if(this.isSenderOnly)return this.sender;switch(this.address){case this.recipient:return this.sender;case this.sender:return this.recipient;default:return this.address}},headline(){if(this.isRecipientOnly)return this.$t("general.received");if(this.isSenderOnly)return this.$t("general.sent");const t="failure"===this.txStatus;switch(this.address){case this.recipient:return t?this.$t("general.failedToReceive"):this.$t("general.receivedFrom");case this.sender:return t?this.$t("general.failedToSend"):this.$t("general.sentTo");default:return this.$t("general.unknown")}},isRecipientOnly(){return!(!this.recipient||this.sender)},isSenderOnly(){return!(this.recipient||!this.sender)},recipient(){return this.activity.to?.toLowerCase()??""},sender(){return this.activity.from?.toLowerCase()??""},status(){return this.txStatus?this.$t(`general.${this.txStatus}`):`${this.$t("general.loading")}...`},symbol(){const{token:t}=this,e="symbol"in t?t.symbol:t.contract.symbol;return e},type(){return this.activity.type},value(){let{token:t}=this;return t=Object.assign({},t,{balance:d.Z.formatNumber(this.activity.value)}),d.Z.formatNumber(p.Z.tokenDecimal(t))}},watch:{activity:{deep:!0,handler(){this.txStatus!==this.activity.status&&this.updateActivity()}},displayAddress(){this.updateAddress()}},beforeDestroy(){clearInterval(this.updateActivityInterval),clearInterval(this.updateTimeOfActivityInterval)},mounted(){this.updateActivity(),this.updateToken(),this.updateAddress(),this.updateTimeOfActivity()},methods:{assembleEvmActivity(t){const e=t.status?"success":"failure";return this.txStatus=e,{block:t.blockNumber,chain:this.activity.chain,contract:this.activity.contract??t.contractAddress,from:this.activity.from,hash:t.transactionHash,status:e,time:(new Date).getTime(),to:this.activity.to,type:this.activity.type,unindexed:!0,value:this.activity.value}},fromNow:u.ZP.fromNow,openTransactionDetail(t){const e=this.$store.getters.transactionDetailsUrl(t,this.token.chain);this.$platform.openNewTab(e)},async requestUpdatedTransactions(){if(await this.$store.dispatch("getTransactions",this.activity.chain),this.$store.getters.allTransactions.find((t=>t.hash===this.activity.hash))){const{chain:t,hash:e,type:i}=this.activity;this.$store.dispatch("clearPendingTransaction",e),this.$store.dispatch("getTokensForChain",{chain:t,type:i}),this.updateTimeOfActivity()}else{const t=this.delay[this.type]??this.BASE_DELAY;setTimeout((()=>this.requestUpdatedTransactions()),t)}},async resolveEnsAddress(){try{this.prettyAddress=await this.$ens.resolveAddress(this.displayAddress)}catch(t){}},updateActivity(){if(this.txStatus=this.activity.status,"pending"!==this.txStatus||this.updateActivityInterval){if((0,r.ij)(this.activity.chain)){const t=-1;this.txStatus=this.activity.block===t?"failure":"success"}}else{this.$nextTick((()=>this.updateTxStatus()));const t=this.delay[this.type]??this.BASE_DELAY;this.updateActivityInterval=window.setInterval(this.updateTxStatus,t)}},updateAddress(){this.prettyAddress=h.Z.elideAddress(this.displayAddress),this.resolveEnsAddress()},updateTimeOfActivity(t){clearInterval(this.updateTimeOfActivityInterval);const e=()=>{const e=(new Date).getTime(),{time:i}=this.activity;if(!t&&e-i>=u.EB)return this.updateTimeOfActivity(u.EB);this.timeOfActivity="pending"===this.txStatus?"":this.fromNow(e,i)};e(),this.updateTimeOfActivityInterval=window.setInterval(e,t??u.sh)},async updateToken(){const{contract:t,chain:e,type:i}=this.activity;if(p.Z.isNativeTokenType(i)?this.token=this.$store.getters.matchingNativeToken(i):this.token=this.$store.getters.getTokenViaSerializedKey(t,e),!this.token&&(0,r.cA)(e)){const i=await((0,l.Z)(e).getTokenInfo?.(t));i&&(this.token=p.Z.makeEvmToken(i,e))}},async updateTxStatus(){if(this.updatingTxStatus)return;if(this.updatingTxStatus=!0,"pending"!==this.txStatus)return clearInterval(this.updateActivityInterval),void(this.updatingTxStatus=!1);const t=n.B1.find((t=>(0,r.F2)(t.chain,this.activity.chain)));if(t?.rpcUrls?.length){const[e]=t.rpcUrls,[i]=e.split("//"),s=new Map([["https:","JsonRpcProvider"],["wss:","WebSocketProvider"]]),a=s.get(i),n=new c[a](e),r=await n.waitForTransaction(this.activity.hash);"status"in r&&(clearInterval(this.updateActivityInterval),this.$store.dispatch("clearPendingTransaction",this.activity.hash),this.$store.dispatch("addTransaction",{chain:this.activity.chain,tx:this.assembleEvmActivity(r)}))}else await this.$store.dispatch("getTransactions",this.activity.chain);this.updatingTxStatus=!1}}}),y=v,f=i(1001),m=(0,f.Z)(y,s,a,!1,null,null,null),g=m.exports},12393:function(t,e,i){i.d(e,{Z:function(){return u}});var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"backdrop-blur-2xl bg-dark-N16 cursor-pointer fixed h-14 right-6 rounded-full transition-opacity w-14",style:{opacity:t.showBackToTopOpacity,bottom:t.showBackToTopBottom+"px"},on:{click:function(e){return e.stopPropagation(),t.scrollToTop.apply(null,arguments)}}},[s("img",{staticClass:"mx-auto",style:{marginTop:"23px"},attrs:{src:i(80779)}})])},a=[];const n=22,r=56,c=window.innerHeight;var o={name:"BackToTop",data(){return{showBackToTopBottom:-r,showBackToTopOpacity:0}},computed:{scrollableEl(){return this.$el.parentElement}},beforeUnmount(){this.scrollableEl.removeEventListener("scroll",this.onScroll)},mounted(){this.scrollableEl.addEventListener("scroll",this.onScroll)},methods:{onScroll(t){const e=c,{scrollTop:i}=t.target,s=i-e;if(s>0){this.showBackToTopOpacity=1;let t=-r+s;t>n&&(t=n),this.showBackToTopBottom=t}else this.showBackToTopOpacity=0},scrollToTop(){this.scrollableEl.scrollTo(0,0)}}},l=o,d=i(1001),h=(0,d.Z)(l,s,a,!1,null,null,null),u=h.exports},98144:function(t,e,i){i.r(e),i.d(e,{default:function(){return u}});var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flex flex-col"},[s("top-bar",{attrs:{"test-parent-name":"notifications_view",title:t.$t("general.notifications")}}),t.allTransactions.length?s("div",{staticClass:"p-5"},t._l(t.allTransactions,(function(t,e){return s("activity-item",{key:e,attrs:{activity:t}})})),1):s("div",{staticClass:"flex flex-col flex-grow justify-center px-14"},[s("div",{staticClass:"flex flex-row justify-center"},[s("div",{},[s("div",{staticClass:"algin-right bg-contain bg-no-repeat bg-squircle-dark h-32 p-8 pl-9 relative w-32"},[s("img",{attrs:{src:i(29395)}})])]),s("div",{staticClass:"flex flex-col justify-center px-8"},[s("div",{staticClass:"font-bold text-2xl text-dark-N77 tracking-wider"},[t._v(" "+t._s(t.$t("general.nothingHere"))+" ")]),s("div",{staticClass:"leading-5 mt-4 text-dark-N77 tracking-wider"},[t._v(" "+t._s(t.$t("views.notificationsView.notifications"))+" ")])])])]),s("back-to-top")],1)},a=[],n=i(18027),r=i(12393),c=i(75619),o={name:"NotificationsView",components:{ActivityItem:n.Z,BackToTop:r.Z,TopBar:c.Z},computed:{allTransactions(){return this.$store.getters.allTransactions}}},l=o,d=i(1001),h=(0,d.Z)(l,s,a,!1,null,null,null),u=h.exports},27176:function(t,e,i){t.exports=i.p+"img/complete_big.7b89d131.svg"},71643:function(t,e,i){t.exports=i.p+"img/in_progress_big.1c0baf16.svg"},29395:function(t,e,i){t.exports=i.p+"img/buzzer.359b57db.svg"},80779:function(t,e,i){t.exports=i.p+"img/chevron_up.dbe760c6.svg"}}]);