"use strict";(self["webpackChunkdesktop_wallet"]=self["webpackChunkdesktop_wallet"]||[]).push([[293],{10816:function(e,t,n){n.r(t),n.d(t,{default:function(){return k}});var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"add-token-view flex flex-col px-14"},[n("top-bar",{staticClass:"-mx-14",attrs:{title:e.$t("views.networksView.addToken")}}),n("div",{staticClass:"before:absolute before:bg-status-warning before:block before:h-full before:left-0 before:opacity-15 before:rounded-lg before:top-0 before:w-full mb-8 mt-9 p-4 relative text-status-warning text-xs"},[e._v(" "+e._s(e.$t("views.networksView.addTokenWarning"))+" ")]),n("token-form",{staticClass:"flex-grow",on:{tokenFormCancelled:e.createTokenCancelled,tokenFormConfirmed:e.createToken}}),n("multi-purpose-popup",{ref:"newTokenPopup"})],1)},o=[],s=n(2714),a=n(43941),i=n(60981),l=n(75619),c=n(20144),u=n(25108),d=c.Z.extend({name:"AddToken",components:{MultiPurposePopup:a.Z,TokenForm:i.Z,TopBar:l.Z},data(){return{token:null}},computed:{newTokenPopup(){return this.$refs.newTokenPopup}},methods:{back(){this.$router.back()},async createToken(e){const t=this.newTokenPopup;t.show({description:this.$t("components.popovers.savingChanges"),popupType:"loader"}),await this.$store.dispatch("addCustomToken",e).then((n=>{if(!n)return Promise.reject(new Error("Unknown error"));{const n=this.$t("general.token");t.show({description:this.$t("views.networksView.successfullyAddedPopupDescription",{type:n}),popupType:"success",title:this.$t("views.networksView.successfullyAddedPopupTitle",{type:n})}),t.$once("popupConfirmed",this.back),this.$store.dispatch("getTokensForChain",{chain:e.chain,type:s.i.NATIVE})}})).catch((n=>{u.error(`Error during custom token ${e.name} create`,n),this.$errorReporter.reportError(n,{extraData:{tokenAddress:e.contract,tokenName:e.name}}),t.show({description:this.$t("errors.generic.somethingWentWrong"),popupType:"error"})}))},createTokenCancelled(){this.back()}}}),m=d,p=n(1001),h=(0,p.Z)(m,r,o,!1,null,null,null),k=h.exports},60981:function(e,t,n){n.d(t,{Z:function(){return b}});var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flex flex-col token-form"},[e.tokenCreateMode?[n("div",{staticClass:"font-medium mb-4 text-base text-white"},[e._v(" "+e._s(e.$t("general.network"))+" ")]),n("network-selector",{staticClass:"mb-8 relative",attrs:{"networks-list":e.customNetworks},model:{value:e.token.chain,callback:function(t){e.$set(e.token,"chain",t)},expression:"token.chain"}}),n("opera-input",e._b({staticClass:"mb-8",attrs:{label:e.$t("general.tokenName"),name:"name",placeholder:e.$t("general.tokenName")},on:{input:e.validate},model:{value:e.token.name,callback:function(t){e.$set(e.token,"name","string"===typeof t?t.trim():t)},expression:"token.name"}},"opera-input",Object.assign({},e.showError("name")),!1))]:e._e(),e._l(e.formFieldsConfig,(function(t){return n("opera-input",e._b({key:"token-form-field-"+t.name,staticClass:"mb-8",attrs:{label:t.label,name:t.name,placeholder:t.label},on:{input:e.validate},model:{value:e.token[t.name],callback:function(n){e.$set(e.token,t.name,n)},expression:"token[field.name]"}},"opera-input",Object.assign({},e.showError(t.name)),!1))})),n("div",{staticClass:"flex-grow"}),n("div",{staticClass:"flex justify-between mb-10"},[n("outlined-button",{staticClass:"w-44",attrs:{title:e.$t("general.cancel")},on:{click:e.tokenFormCancelled}}),n("primary-button",{staticClass:"w-44",attrs:{disabled:e.formInvalid,title:e.$t("general."+(e.tokenCreateMode?"add":"save"))},on:{click:e.tokenFormConfirmed}})],1)],2)},o=[],s=n(85512),a=n(2714),i=n(70794),l=n(76964),c=n(17482),u=n(89504),d=n(68461),m=n(20144),p=m.Z.extend({name:"TokenForm",components:{NetworkSelector:l.Z,OperaInput:c.Z,OutlinedButton:u.Z,PrimaryButton:d.Z},props:{tokenData:{default:null,type:Object}},data(){const[e]=this.$store.getters.customNetworks;return{error:{},formInvalid:!1,showDeleteConfirmationPopup:!1,token:{address:"",chain:e.chain,decimals:null,name:"",symbol:""}}},computed:{chain(){const{chain:e}=this.$route.query;return e?JSON.parse(e):null},customNetworks(){return this.$store.getters.customNetworks},formFieldsConfig(){return[{label:this.$t("general.contractAddress"),name:"address"},{label:this.$t("general.symbol"),name:"symbol"},{label:this.$t("general.decimal"),name:"decimals"}]},tokenCreateMode(){return!this.tokenData},tokenFormFields(){return this.$children.filter((e=>e.$options._componentTag?.includes("opera-input")))}},watch:{error:{deep:!0,handler(e){this.formInvalid=!!Object.values(e).length}}},mounted(){if(this.tokenData)for(const e in this.tokenData)this.token[e]=this.tokenData[e];this.chain&&(this.token.chain=this.chain)},methods:{showError(e){return e in this.error?{error:this.error[e],icon:"icon-error"}:null},tokenFormCancelled(){this.$emit("tokenFormCancelled")},tokenFormConfirmed(){if(this.validateAll()){const{token:e}=this,t={address:e.address,chain:e.chain,decimals:new i.Z(e.decimals).toNumber(),name:e.name,symbol:e.symbol,type:a.i.FUNGIBLE};this.$emit("tokenFormConfirmed",t)}},validate(e,t){const{target:n}=t,{name:r}=n;let o={...this.error};const s=this.validator(r,e);s.fieldIsValid?delete o[r]:o=Object.assign({},o,{[r]:s.message}),this.error=o},validateAll(){const e={},t=this.tokenFormFields;return t.forEach((({name:t,value:n})=>{const r=this.validator(t,n);r.fieldIsValid||(e[t]=r.message)})),this.error=e,!Object.entries(this.error).length},validator(e,t){let n,r=!0;switch(e){case"name":r=!!t,n=this.$t("errors.generic.incorrectField",{fieldName:this.$t("general.tokenName")});break;case"address":r=s.Ze(t),n=this.$t("errors.generic.incorrectField",{fieldName:this.$t("general.contract")});break;case"symbol":r=s.HA(t),n=this.$t("errors.generic.incorrectField",{fieldName:this.$t("general.symbol")});break;case"decimals":r=s.xP(t),n=this.$t("errors.generic.incorrectField",{fieldName:this.$t("general.decimal")});break;default:r=!0,n=""}return{fieldIsValid:r,message:n}}}}),h=p,k=n(1001),f=(0,k.Z)(h,r,o,!1,null,null,null),b=f.exports},85512:function(e,t,n){n.d(t,{Ff:function(){return p},HA:function(){return m},JW:function(){return u},Ze:function(){return d},wC:function(){return c},xP:function(){return i}});var r=n(70794),o=n(38531),s=n.n(o);function a(e){return(0,r.Z)(e)}function i(e){return a(e).isPositive()}function l(e){return/^(https?):\/\/.+$/.test(e)}function c(e){return/^(|wss?):\/\/.+$/.test(e)||l(e)}function u(e){const t=a(e);return t.isInteger()&&t.isPositive()}function d(e){return s().validate(e,"ETH")}function m(e){return/^[a-zA-Z]+$/.test(e)}function p(e){return l(e)}}}]);