"use strict";(self["webpackChunkdesktop_wallet"]=self["webpackChunkdesktop_wallet"]||[]).push([[555],{38555:function(e,t,n){n.r(t),n.d(t,{default:function(){return p}});var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flex flex-col px-14 relative token-details-view"},[n("top-bar",{staticClass:"-mx-14",attrs:{title:e.token.name},scopedSlots:e._u([{key:"action",fn:function(){return[n("button",{attrs:{type:"button"},on:{click:e.removeCustomToken}},[n("i",{staticClass:"font-normal icon-delete text-brand-primary"})])]},proxy:!0}])}),n("token-form",{staticClass:"flex-grow",attrs:{"token-data":e.token},on:{tokenFormCancelled:e.back,tokenFormConfirmed:e.tokenUpdateConfirmed}}),n("multi-purpose-popup",{ref:"tokenPopup"})],1)},r=[],s=n(43941),a=n(60981),i=n(75619),l=n(20144),c=n(25108),u=l.Z.extend({name:"TokenDetails",components:{MultiPurposePopup:s.Z,TokenForm:a.Z,TopBar:i.Z},computed:{token(){return this.$route.params.token},tokenPopup(){return this.$refs.tokenPopup}},methods:{back(){this.$router.back()},removeCustomToken(){const{name:e}=this.token,t=this.tokenPopup;t.show({cancelButtonTitle:this.$t("general.cancel"),description:this.$t("views.networksView.deleteTokenPopupDescription",{tokenName:e}),title:this.$t("views.networksView.deleteTokenPopupTitle")}),t.$once("popupConfirmed",this.removeCustomTokenConfirmed)},async removeCustomTokenConfirmed(){const{address:e,chain:t,name:n}=this.token,o=n,r=this.tokenPopup;this.showLoader(),await this.$store.dispatch("removeCustomToken",{address:e,chain:t}).then((()=>{this.showSuccess(),r.$once("popupConfirmed",this.back)})).catch((t=>{c.error(`Error during custom token ${o} remove: ${t}`),this.$errorReporter.reportError(t,{extraData:{tokenAddress:e,tokenName:o}}),this.showError()}))},showError(e){const t=this.tokenPopup;t.show({description:e||this.$t("errors.generic.somethingWentWrong"),popupType:"error"})},showLoader(){const e=this.tokenPopup;e.show({description:this.$t("components.popovers.savingChanges"),popupType:"loader"})},showSuccess(){const e=this.tokenPopup;e.show({popupType:"success",title:this.$t("general.success")})},async tokenUpdateConfirmed(e){this.showLoader(),await this.$store.dispatch("updateCustomToken",e).then((e=>{e&&this.showSuccess()})).catch((t=>{c.error(`Error during custom chain update ${e.name}: ${t}`),this.$errorReporter.reportError(t,{extraData:{tokenName:e.name}}),this.showError()}))}}}),m=u,d=n(1001),h=(0,d.Z)(m,o,r,!1,null,null,null),p=h.exports},60981:function(e,t,n){n.d(t,{Z:function(){return b}});var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flex flex-col token-form"},[e.tokenCreateMode?[n("div",{staticClass:"font-medium mb-4 text-base text-white"},[e._v(" "+e._s(e.$t("general.network"))+" ")]),n("network-selector",{staticClass:"mb-8 relative",attrs:{"networks-list":e.customNetworks},model:{value:e.token.chain,callback:function(t){e.$set(e.token,"chain",t)},expression:"token.chain"}}),n("opera-input",e._b({staticClass:"mb-8",attrs:{label:e.$t("general.tokenName"),name:"name",placeholder:e.$t("general.tokenName")},on:{input:e.validate},model:{value:e.token.name,callback:function(t){e.$set(e.token,"name","string"===typeof t?t.trim():t)},expression:"token.name"}},"opera-input",Object.assign({},e.showError("name")),!1))]:e._e(),e._l(e.formFieldsConfig,(function(t){return n("opera-input",e._b({key:"token-form-field-"+t.name,staticClass:"mb-8",attrs:{label:t.label,name:t.name,placeholder:t.label},on:{input:e.validate},model:{value:e.token[t.name],callback:function(n){e.$set(e.token,t.name,n)},expression:"token[field.name]"}},"opera-input",Object.assign({},e.showError(t.name)),!1))})),n("div",{staticClass:"flex-grow"}),n("div",{staticClass:"flex justify-between mb-10"},[n("outlined-button",{staticClass:"w-44",attrs:{title:e.$t("general.cancel")},on:{click:e.tokenFormCancelled}}),n("primary-button",{staticClass:"w-44",attrs:{disabled:e.formInvalid,title:e.$t("general."+(e.tokenCreateMode?"add":"save"))},on:{click:e.tokenFormConfirmed}})],1)],2)},r=[],s=n(85512),a=n(2714),i=n(70794),l=n(76964),c=n(17482),u=n(89504),m=n(68461),d=n(20144),h=d.Z.extend({name:"TokenForm",components:{NetworkSelector:l.Z,OperaInput:c.Z,OutlinedButton:u.Z,PrimaryButton:m.Z},props:{tokenData:{default:null,type:Object}},data(){const[e]=this.$store.getters.customNetworks;return{error:{},formInvalid:!1,showDeleteConfirmationPopup:!1,token:{address:"",chain:e.chain,decimals:null,name:"",symbol:""}}},computed:{chain(){const{chain:e}=this.$route.query;return e?JSON.parse(e):null},customNetworks(){return this.$store.getters.customNetworks},formFieldsConfig(){return[{label:this.$t("general.contractAddress"),name:"address"},{label:this.$t("general.symbol"),name:"symbol"},{label:this.$t("general.decimal"),name:"decimals"}]},tokenCreateMode(){return!this.tokenData},tokenFormFields(){return this.$children.filter((e=>e.$options._componentTag?.includes("opera-input")))}},watch:{error:{deep:!0,handler(e){this.formInvalid=!!Object.values(e).length}}},mounted(){if(this.tokenData)for(const e in this.tokenData)this.token[e]=this.tokenData[e];this.chain&&(this.token.chain=this.chain)},methods:{showError(e){return e in this.error?{error:this.error[e],icon:"icon-error"}:null},tokenFormCancelled(){this.$emit("tokenFormCancelled")},tokenFormConfirmed(){if(this.validateAll()){const{token:e}=this,t={address:e.address,chain:e.chain,decimals:new i.Z(e.decimals).toNumber(),name:e.name,symbol:e.symbol,type:a.i.FUNGIBLE};this.$emit("tokenFormConfirmed",t)}},validate(e,t){const{target:n}=t,{name:o}=n;let r={...this.error};const s=this.validator(o,e);s.fieldIsValid?delete r[o]:r=Object.assign({},r,{[o]:s.message}),this.error=r},validateAll(){const e={},t=this.tokenFormFields;return t.forEach((({name:t,value:n})=>{const o=this.validator(t,n);o.fieldIsValid||(e[t]=o.message)})),this.error=e,!Object.entries(this.error).length},validator(e,t){let n,o=!0;switch(e){case"name":o=!!t,n=this.$t("errors.generic.incorrectField",{fieldName:this.$t("general.tokenName")});break;case"address":o=s.Ze(t),n=this.$t("errors.generic.incorrectField",{fieldName:this.$t("general.contract")});break;case"symbol":o=s.HA(t),n=this.$t("errors.generic.incorrectField",{fieldName:this.$t("general.symbol")});break;case"decimals":o=s.xP(t),n=this.$t("errors.generic.incorrectField",{fieldName:this.$t("general.decimal")});break;default:o=!0,n=""}return{fieldIsValid:o,message:n}}}}),p=h,k=n(1001),f=(0,k.Z)(p,o,r,!1,null,null,null),b=f.exports},85512:function(e,t,n){n.d(t,{Ff:function(){return h},HA:function(){return d},JW:function(){return u},Ze:function(){return m},wC:function(){return c},xP:function(){return i}});var o=n(70794),r=n(38531),s=n.n(r);function a(e){return(0,o.Z)(e)}function i(e){return a(e).isPositive()}function l(e){return/^(https?):\/\/.+$/.test(e)}function c(e){return/^(|wss?):\/\/.+$/.test(e)||l(e)}function u(e){const t=a(e);return t.isInteger()&&t.isPositive()}function m(e){return s().validate(e,"ETH")}function d(e){return/^[a-zA-Z]+$/.test(e)}function h(e){return l(e)}}}]);